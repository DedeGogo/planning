(this.webpackJsonpplanning=this.webpackJsonpplanning||[]).push([[3],{59:function(e,n,t){e.exports=t.p+"static/media/logo.e069865e.jpg"},68:function(e,n,t){e.exports=t(84)},84:function(e,n,t){"use strict";t.r(n);var a=t(0),r=t.n(a),o=t(52),l=t.n(o),i=t(39),c=t(97),s=t(32),u=t(38),m=t(96),d=t(58),p=t.n(d),g=t(60),f=t(61),b=t(89),h=t(59),E=t.n(h),v=function(e){return r.a.createElement(b.a,Object.assign({},e,{src:E.a,alt:"Logo de La Chouette Coop"}))},w=function(){return r.a.createElement(g.a,{bg:"primary",minHeight:"100vh",flexDirection:"column",justifyContent:"center",alignItems:"center",px:4},r.a.createElement(v,{border:"2px solid white",objectFit:"cover",mb:10}),r.a.createElement(f.a,{size:"xl",color:"white"}))},x=r.a.createContext(),y=function(e){var n=Object(m.a)("token","",!0),t=Object(u.a)(n,2),a=t[0],o=t[1],l=r.a.useState("initializing"),i=Object(u.a)(l,2),c=i[0],d=i[1],g=Object(s.c)("\n  mutation Login($email: String!, $password: String!) {\n    loginChouettos(input: {\n      email: $email\n      password: $password\n    }) {\n      token\n    }\n  }\n"),f=Object(u.a)(g,2),b=f[0],h=f[1];if(r.a.useEffect((function(){if(d((function(e){return"loggedIn"!==e&&a?"loggedIn":"loggedIn"!==e&&"initializing"!==e||a?e:"loggedOut"})),a){var e=p()(a),n=setTimeout((function(){return o("")}),Math.max(1,1e3*e.exp-Date.now()));return function(){return clearTimeout(n)}}}),[a,o]),r.a.useEffect((function(){(b.fetching||"pending"===c)&&(b.fetching?d("pending"):b.data&&b.data.loginChouettos.token?o(b.data.loginChouettos.token):d("refused"))}),[b,c,o]),"initializing"===c)return r.a.createElement(w,null);return r.a.createElement(x.Provider,Object.assign({value:{authState:c,token:a,login:function(e){var n=e.email,t=e.password;h({email:n,password:t})},logout:function(){return o("")}}},e))},C=function(){return r.a.useContext(x)},j=t(50),z=t(95),k=t(63);t.n(k).a.load({google:{families:["Cabin","Montserrat","Libre Barcode 128 Text"]}});var O=Object(j.a)({},z.a,{colors:Object(j.a)({},z.a.colors,{},{primary:"#445448",paleyellow:"#f5eeae",darkyellow:"#e6c56d",lightbrown:"#d8b881",brown:"#b88c56",darkbrown:"#ba7c40",paleviolet:"#eee1e9",greyblue:"#d3d8d3",greyblue2:"#d7d8d9",violet:"#c0b9c0",palegreen:"#d7daba",lightgreen:"#c0d29f",blue:"#b6cab6",black:"#344237",gray:{50:"#ecedeb",100:"#d7d9d6",200:"#bfc3bd",300:"#a3a9a1",400:"#7f877c",500:"#485444",600:"#404b3c",700:"#374134",800:"#2d342a",900:"#1e231d"}}),fonts:{heading:"Montserrat, sans-serif",body:"Cabin, sans-serif",mono:'SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace'}}),S=Object(s.b)({url:"https://api.lachouettecoop.fr/graphql",fetchOptions:function(){var e=window&&window.sessionStorage&&window.sessionStorage.getItem("token");return e?{headers:{authorization:e}}:{}}}),I=function(e){var n=e.children;return r.a.createElement(i.a,{theme:O},r.a.createElement(c.a,null),r.a.createElement(s.a,{value:S},r.a.createElement(y,null,n)))},L=t(5),M=t(66),P=t(85),R=t(37),q=t(31),A=t(90),W=t(91),T=t(92),B=function(){return r.a.createElement(L.a,null,r.a.createElement(L.a,{mb:4},r.a.createElement(A.a,{size:"2xl"},"Bienvenue")),r.a.createElement(W.a,{spacing:4,align:"stretch"},r.a.createElement(M.a,{fontSize:"xl"},"Que voulez-vous faire ?"),r.a.createElement(T.a,{as:R.b,to:"/me-positionner"},r.a.createElement(P.a,{size:"lg",w:"100%"},"Se positionner pour une PIAF")),r.a.createElement(T.a,{as:R.b,to:"/planning/aujourdhui"},r.a.createElement(P.a,{size:"lg",w:"100%"},"Voir le planning du jour")),r.a.createElement(T.a,{as:R.b,to:"/planning"},r.a.createElement(P.a,{size:"lg",w:"100%"},"Voir le planning global"))))},F=r.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(7),t.e(9)]).then(t.bind(null,166))})),V=r.a.lazy((function(){return Promise.all([t.e(0),t.e(2),t.e(6),t.e(10)]).then(t.bind(null,172))})),$=r.a.lazy((function(){return Promise.all([t.e(0),t.e(1),t.e(2),t.e(8)]).then(t.bind(null,189))})),D=function(){var e=C().logout,n=Object(s.d)({query:"{\n      me {\n        prenom\n      }\n    }"}),t=Object(u.a)(n,1)[0];return t.fetching?r.a.createElement(w,null):t.error?"Oops, une erreur est survenue. Contactez les personnes en charge SVP.":r.a.createElement(r.a.Suspense,{fallback:r.a.createElement(w,null)},r.a.createElement(L.a,null,r.a.createElement(g.a,{as:"header",bg:"primary",py:2,px:4,mb:4,justifyContent:"space-between"},r.a.createElement(M.a,{fontSize:"xl",color:"white"},"Bienvenue ",t.data.me.prenom,"\xa0!"),r.a.createElement(P.a,{onClick:e,size:"sm"},"Se d\xe9connecter")),r.a.createElement(R.a,null,r.a.createElement(L.a,{px:4},r.a.createElement(q.c,null,r.a.createElement(q.a,{path:"/",exact:!0},r.a.createElement(B,null)),r.a.createElement(q.a,{path:"/me-positionner",exact:!0},r.a.createElement(F,null)),r.a.createElement(q.a,{path:"/planning",exact:!0},r.a.createElement(V,null)),r.a.createElement(q.a,{path:"/planning/:date"},r.a.createElement($,null)))))))},N=t(98),U=t(40),J=t(93),H=t(99),Q=t(94),G=function(e){return r.a.createElement(T.a,Object.assign({isExternal:!0,href:"https://adminchouettos.lachouettecoop.fr/resetting/request"},e),e.children||"r\xe9initialiser votre mot de passe")},K=function(){var e=C(),n=e.login,t=e.authState,o=Object(a.useRef)(null),l=Object(a.useRef)(null);Object(a.useEffect)((function(){o.current.focus()}),[]);return r.a.createElement(L.a,{w:"80%",mx:"auto"},r.a.createElement(A.a,{as:"h1",my:10},"Connexion requise"),r.a.createElement(L.a,{mb:10},r.a.createElement(M.a,null,"Cette application permet de consulter le planning du Lab."),r.a.createElement(M.a,null,"Elle est r\xe9serv\xe9e aux membres de La Chouette Coop. Veuillez vous connecter avec vos identifiants habituels.")),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),n({email:o.current.value,password:l.current.value})}},r.a.createElement(W.a,{spacing:8},"refused"===t&&r.a.createElement(N.a,{status:"error",variant:"left-accent"},r.a.createElement(N.c,null),r.a.createElement(N.d,{mr:2},"Couple email / mot de passe non reconnu."),r.a.createElement(N.b,null,"Veuillez v\xe9rifiez les donn\xe9es transmises ou"," ",r.a.createElement(G,null),".")),r.a.createElement(U.a,{isRequired:!0},r.a.createElement(J.a,{htmlFor:"email"},"Adresse email"),r.a.createElement(H.a,{type:"email",id:"email","aria-describedby":"email-helper-text",ref:o,tabIndex:1}),r.a.createElement(Q.a,{id:"email-helper-text"},"L\u2019adresse email fournie lors de votre inscription.")),r.a.createElement(U.a,{isRequired:!0},r.a.createElement(J.a,{htmlFor:"password"},"Mot de passe"),r.a.createElement(H.a,{type:"password",id:"password","aria-describedby":"password-helper-text",ref:l,tabIndex:2}),r.a.createElement(Q.a,{id:"password-helper-text"},"Identique \xe0 celui utilis\xe9 sur les autres outils de La Chouette Coop. En cas d\u2019oubli, vous pouvez"," ",r.a.createElement(G,{tabIndex:4}),".")),r.a.createElement(P.a,{type:"submit",variantColor:"green",size:"lg",isLoading:"pending"===t,tabIndex:3,loadingText:"Connexion en cours"},"Se connecter"))))},X=function(){return"loggedIn"===C().authState?r.a.createElement(D,null):r.a.createElement(K,null)},Y=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Z(e,n){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}l.a.render(r.a.createElement(I,null,r.a.createElement(X,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/planning",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var n="".concat("/planning","/service-worker.js");Y?(!function(e,n){fetch(e).then((function(t){var a=t.headers.get("content-type");404===t.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):Z(e,n)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(n,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):Z(n,e)}))}}()}},[[68,4,5]]]);
//# sourceMappingURL=main.9b0321a8.chunk.js.map